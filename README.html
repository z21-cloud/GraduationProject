<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Схема взаимодействия</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
            padding: 20px;
            margin: 0;
        }
        .container {
            background: white;
            padding: 30px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            max-width: 900px;
            margin: 0 auto;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        .diagram-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: #f9f9f9;
        }
        .diagram-section h2 {
            color: #3498db;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
            margin-top: 0;
        }
        .connection {
            font-weight: bold;
            color: #e74c3c;
        }
        .component {
            font-weight: bold;
            color: #2980b9;
        }
        .action {
            font-style: italic;
            color: #27ae60;
        }
        .footer {
            text-align: center;
            margin-top: 30px;
            font-size: 0.8em;
            color: #7f8c8d;
        }
        svg {
            width: 100%;
            height: auto;
        }
        .arrow {
            fill: none;
            stroke: #3498db;
            stroke-width: 2;
            marker-end: url(#arrowhead);
        }
        .box {
            fill: #ecf0f1;
            stroke: #2c3e50;
            stroke-width: 2;
            rx: 5;
            ry: 5;
        }
        .box-highlight {
            fill: #d6eaf8;
        }
        text {
            font-family: 'Arial', sans-serif;
            font-size: 14px;
        }
        .subcomponent {
            fill: #f8f9f9;
            stroke: #7f8c8d;
            stroke-width: 1;
            stroke-dasharray: 4, 2;
            rx: 3;
            ry: 3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Схема взаимодействия компонентов</h1>
        
        <div class="diagram-section">
            <h2>Общая схема взаимодействия</h2>
            <svg viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#3498db" />
                    </marker>
                </defs>
                
                <!-- PlayerController -->
                <rect x="50" y="50" width="200" height="80" class="box" />
                <text x="150" y="90" text-anchor="middle" font-weight="bold">PlayerController</text>
                
                <!-- Raycast -->
                <rect x="300" y="50" width="150" height="80" class="box" />
                <text x="375" y="90" text-anchor="middle" font-weight="bold">Raycast</text>
                
                <!-- ItemContext -->
                <rect x="250" y="200" width="200" height="150" class="box box-highlight" />
                <text x="350" y="230" text-anchor="middle" font-weight="bold">ItemContext</text>
                <text x="350" y="255" text-anchor="middle" font-size="12">ID, Type, Frequency</text>
                <text x="350" y="275" text-anchor="middle" font-size="12">Color, State, IsDestroyed</text>
                
                <!-- ItemSpawner -->
                <rect x="50" y="400" width="200" height="80" class="box" />
                <text x="150" y="440" text-anchor="middle" font-weight="bold">ItemSpawner</text>
                
                <!-- ItemFactory -->
                <rect x="300" y="400" width="150" height="80" class="box" />
                <text x="375" y="440" text-anchor="middle" font-weight="bold">ItemFactory</text>
                
                <!-- IItemStateStrategy -->
                <rect x="500" y="200" width="250" height="150" class="box" />
                <text x="625" y="230" text-anchor="middle" font-weight="bold">IItemStateStrategy</text>
                <rect x="520" y="250" width="210" height="30" class="subcomponent" />
                <text x="625" y="270" text-anchor="middle" font-size="12">ActiveStateStrategy</text>
                <rect x="520" y="290" width="210" height="30" class="subcomponent" />
                <text x="625" y="310" text-anchor="middle" font-size="12">PassiveStateStrategy</text>
                <rect x="520" y="330" width="210" height="30" class="subcomponent" />
                <text x="625" y="350" text-anchor="middle" font-size="12">PeriodicStateStrategy</text>
                
                <!-- ItemSpawnConfig -->
                <rect x="50" y="510" width="200" height="50" class="box" />
                <text x="150" y="540" text-anchor="middle" font-weight="bold">ItemSpawnConfig</text>
                
                <!-- Arrows -->
                <path d="M 250 90 L 300 90" class="arrow" />
                <path d="M 250 90 L 275 90 L 275 200" class="arrow" />
                <path d="M 150 400 L 150 510" class="arrow" />
                <path d="M 250 440 L 300 440" class="arrow" />
                <path d="M 375 400 L 375 350 L 350 350" class="arrow" />
                <path d="M 450 275 L 500 275" class="arrow" />
                <path d="M 350 140 L 350 200" class="arrow" />
                
                <!-- Action Labels -->
                <text x="260" y="80" font-size="12">проверяет</text>
                <text x="275" y="160" font-size="12">взаимодействие</text>
                <text x="150" y="480" font-size="12">настройки</text>
                <text x="260" y="430" font-size="12">создаёт</text>
                <text x="400" y="370" font-size="12">инициализирует</text>
                <text x="470" y="260" font-size="12">управляет</text>
            </svg>
        </div>
        
        <div class="diagram-section">
            <h2>Детальное взаимодействие PlayerController</h2>
            <svg viewBox="0 0 800 300" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <marker id="arrowhead2" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#3498db" />
                    </marker>
                </defs>
                
                <!-- PlayerController -->
                <rect x="50" y="50" width="200" height="80" class="box" />
                <text x="150" y="90" text-anchor="middle" font-weight="bold">PlayerController</text>
                
                <!-- Raycast -->
                <rect x="350" y="50" width="150" height="80" class="box" />
                <text x="425" y="90" text-anchor="middle" font-weight="bold">Raycast</text>
                
                <!-- ItemContext -->
                <rect x="350" y="200" width="200" height="80" class="box box-highlight" />
                <text x="450" y="240" text-anchor="middle" font-weight="bold">ItemContext</text>
                
                <!-- CurrentStrategy -->
                <rect x="650" y="200" width="150" height="80" class="box" />
                <text x="725" y="240" text-anchor="middle" font-weight="bold">CurrentStrategy</text>
                
                <!-- Arrows -->
                <path d="M 250 90 L 350 90" class="arrow" marker-end="url(#arrowhead2)" />
                <text x="300" y="80" font-size="12">проверяет объекты</text>
                
                <path d="M 425 130 L 425 200" class="arrow" marker-end="url(#arrowhead2)" />
                <text x="435" y="170" font-size="12">если найден</text>
                
                <path d="M 350 240 L 300 240 L 300 100 L 250 100" class="arrow" marker-end="url(#arrowhead2)" />
                <text x="270" y="150" font-size="12" fill="#e74c3c">ЛКМ → TransmitData()</text>
                <text x="270" y="220" font-size="12" fill="#e74c3c">E → DestroyItem()</text>
                
                <path d="M 550 240 L 650 240" class="arrow" marker-end="url(#arrowhead2)" />
                <text x="600" y="230" font-size="12">TransmitData(ItemData)</text>
            </svg>
        </div>
        
        <div class="diagram-section">
            <h2>Детальное взаимодействие ItemSpawner и ItemFactory</h2>
            <svg viewBox="0 0 800 300" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <marker id="arrowhead3" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#3498db" />
                    </marker>
                </defs>
                
                <!-- ItemSpawner -->
                <rect x="50" y="50" width="200" height="80" class="box" />
                <text x="150" y="90" text-anchor="middle" font-weight="bold">ItemSpawner</text>
                
                <!-- ItemSpawnConfig -->
                <rect x="50" y="200" width="200" height="80" class="box" />
                <text x="150" y="240" text-anchor="middle" font-weight="bold">ItemSpawnConfig</text>
                
                <!-- ItemFactory -->
                <rect x="350" y="50" width="200" height="80" class="box" />
                <text x="450" y="90" text-anchor="middle" font-weight="bold">ItemFactory</text>
                
                <!-- ItemContext -->
                <rect x="650" y="50" width="130" height="80" class="box box-highlight" />
                <text x="715" y="90" text-anchor="middle" font-weight="bold">ItemContext</text>
                
                <!-- Random components -->
                <rect x="350" y="170" width="200" height="110" class="box" />
                <text x="450" y="195" text-anchor="middle" font-weight="bold">Устанавливает:</text>
                <text x="450" y="220" text-anchor="middle">случайный ItemType</text>
                <text x="450" y="245" text-anchor="middle">случайный IItemStateStrategy</text>
                <text x="450" y="270" text-anchor="middle">случайный Interactable</text>
                
                <!-- Arrows -->
                <path d="M 150 130 L 150 200" class="arrow" marker-end="url(#arrowhead3)" />
                <text x="160" y="170" font-size="12">берёт настройки</text>
                
                <path d="M 250 90 L 350 90" class="arrow" marker-end="url(#arrowhead3)" />
                <text x="300" y="80" font-size="12">создаёт предметы</text>
                
                <path d="M 450 130 L 450 170" class="arrow" marker-end="url(#arrowhead3)" />
                
                <path d="M 550 90 L 650 90" class="arrow" marker-end="url(#arrowhead3)" />
                <text x="600" y="80" font-size="12">Initialize(...)</text>
            </svg>
        </div>
        
        <div class="diagram-section">
            <h2>Взаимодействие стратегий состояния</h2>
            <svg viewBox="0 0 800 400" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <marker id="arrowhead4" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#3498db" />
                    </marker>
                </defs>
                
                <!-- ItemContext -->
                <rect x="100" y="150" width="200" height="150" class="box box-highlight" />
                <text x="200" y="180" text-anchor="middle" font-weight="bold">ItemContext</text>
                <text x="200" y="210" text-anchor="middle" font-size="14">Управляет:</text>
                <text x="200" y="235" text-anchor="middle" font-size="12">- изменением цвета</text>
                <text x="200" y="255" text-anchor="middle" font-size="12">- изменением состояния</text>
                <text x="200" y="275" text-anchor="middle" font-size="12">- уничтожением объекта</text>
                
                <!-- IItemStateStrategy -->
                <rect x="450" y="50" width="250" height="80" class="box" />
                <text x="575" y="90" text-anchor="middle" font-weight="bold">IItemStateStrategy</text>
                
                <!-- Strategy implementations -->
                <rect x="450" y="180" width="250" height="60" class="box" />
                <text x="575" y="215" text-anchor="middle" font-weight="bold">ActiveStateStrategy</text>
                
                <rect x="450" y="260" width="250" height="60" class="box" />
                <text x="575" y="295" text-anchor="middle" font-weight="bold">PassiveStateStrategy</text>
                
                <rect x="450" y="340" width="250" height="60" class="box" />
                <text x="575" y="375" text-anchor="middle" font-weight="bold">PeriodicStateStrategy</text>
                
                <!-- Arrows -->
                <path d="M 300 200 L 450 90" class="arrow" marker-end="url(#arrowhead4)" />
                <text x="350" y="130" font-size="12">взаимодействует</text>
                
                <path d="M 575 130 L 575 180" class="arrow" marker-end="url(#arrowhead4)" />
                <path d="M 575 240 L 575 260" class="arrow" marker-end="url(#arrowhead4)" />
                <path d="M 575 320 L 575 340" class="arrow" marker-end="url(#arrowhead4)" />
                
                <path d="M 450 210 L 350 210 L 350 225 L 300 225" class="arrow" marker-end="url(#arrowhead4)" />
                <text x="380" y="205" font-size="12">TransmitData()</text>
                
                <path d="M 450 370 L 350 370 L 350 260 L 300 260" class="arrow" marker-end="url(#arrowhead4)" />
                <text x="380" y="350" font-size="12">периодическое поведение</text>
            </svg>
        </div>
        
        <div class="footer">
            <p>Схема сгенерирована на основе markdown скрипта • Дата: 15.05.2025</p>
        </div>
    </div>
</body>
</html>
